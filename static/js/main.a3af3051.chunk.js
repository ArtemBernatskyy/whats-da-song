(this.webpackJsonpsrc=this.webpackJsonpsrc||[]).push([[0],{27:function(e,t,a){e.exports=a(56)},32:function(e,t,a){},55:function(e,t,a){},56:function(e,t,a){"use strict";a.r(t);var s=a(1),n=a.n(s),i=a(5),r=a.n(i),o=(a(32),a(3)),c=a.n(o),u=a(19),d=a(20),h=a(25),m=a(21),l=a(26),p=a(6),f=(a(34),a(22)),g=a(24),v=a(4),w=a.n(v),N=a(23),k=a.n(N),E=(a(55),{DENIED:"denied",PROMPT:"prompt",GRANTED:"granted",UNKNOWN:"unknown"}),R=function(e){function t(e){var a;return Object(u.a)(this,t),(a=Object(h.a)(this,Object(m.a)(t).call(this,e))).showNotification=function(e,t){p.b.dismiss(),p.b[e](t,{hideProgressBar:!0})},a.toggleRecording=function(){return c.a.async((function(e){for(;;)switch(e.prev=e.next){case 0:a.state.isRecording?a.stopRecording():(a.chunks=[],a.mediaRecorder.start(10),setTimeout((function(){"recording"===a.mediaRecorder.state&&a.stopRecording()}),1e4),a.setState({isAnimating:!0,isRecording:!0}));case 2:case"end":return e.stop()}}))},a.state={isAnimating:!1,permissionsStatus:E.UNKNOWN,isRecording:!1},a.mediaRecorder=null,a.chunks=[],a}return Object(l.a)(t,e),Object(d.a)(t,[{key:"componentDidMount",value:function(){return c.a.async((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,c.a.awrap(this.checkPermissions());case 2:this.state.permissionsStatus===E.GRANTED&&this.initMediaRecorder();case 3:case"end":return e.stop()}}),null,this)}},{key:"initMediaRecorder",value:function(){var e,t=this;return c.a.async((function(a){for(;;)switch(a.prev=a.next){case 0:return a.next=2,c.a.awrap(navigator.mediaDevices.getUserMedia({audio:!0,video:!1}));case 2:e=a.sent,this.mediaRecorder=new MediaRecorder(e),this.mediaRecorder.ondataavailable=function(e){e.data&&e.data.size>0&&t.chunks.push(e.data)};case 5:case"end":return a.stop()}}),null,this)}},{key:"checkPermissions",value:function(){var e;return c.a.async((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,c.a.awrap(navigator.permissions.query({name:"microphone"}));case 2:if((e=t.sent).state!==E.GRANTED){t.next=8;break}this.showNotification("info","Audio permissions granted"),this.setState({permissionsStatus:E.GRANTED}),t.next=26;break;case 8:if(e.state!==E.PROMPT){t.next=25;break}return this.showNotification("info","Plz allow audio permissions"),this.setState({permissionsStatus:E.PROMPT}),t.prev=11,t.next=14,c.a.awrap(navigator.mediaDevices.getUserMedia({audio:!0,video:!1}));case 14:t.sent.getTracks().forEach((function(e){return e.stop()})),this.showNotification("success","Audio permissions granted"),this.setState({permissionsStatus:E.GRANTED}),t.next=23;break;case 20:t.prev=20,t.t0=t.catch(11),t.t0.message&&"Permission denied"===t.t0.message&&(this.showNotification("error","Audio permissions denied"),this.setState({permissionsStatus:E.DENIED}));case 23:t.next=26;break;case 25:e.state===E.DENIED&&(this.showNotification("error","Audio permissions denied"),this.setState({permissionsStatus:E.DENIED}));case 26:case"end":return t.stop()}}),null,this,[[11,20]])}},{key:"stopRecording",value:function(){return c.a.async((function(e){for(;;)switch(e.prev=e.next){case 0:return this.mediaRecorder.stop(),e.next=3,c.a.awrap(this.sendAudio());case 3:this.setState({isAnimating:!1,isRecording:!1});case 4:case"end":return e.stop()}}),null,this)}},{key:"sendAudio",value:function(){var e,t,a,s;return c.a.async((function(n){for(;;)switch(n.prev=n.next){case 0:return e=new Blob(this.chunks,{type:"audio/webm"}),(t=new FormData).append("file",e,"recording.webm"),a={headers:{"content-type":"multipart/form-data"}},n.prev=4,n.next=7,c.a.awrap(k.a.post("https://dude-what-is-the-song.herokuapp.com/song/searchByFile",t,a));case 7:200===(s=n.sent).status?this.showNotification("success","".concat(s.data.artist," - ").concat(s.data.title)):this.showNotification("warning","Can't find any matching song"),n.next=14;break;case 11:n.prev=11,n.t0=n.catch(4),this.showNotification("error","Backend error");case 14:case"end":return n.stop()}}),null,this,[[4,11]])}},{key:"render",value:function(){var e=this.state,t=e.isAnimating,a=e.permissionsStatus,s=w()({logo:!0,"logo--animate":t,"logo--disabled":a!==E.GRANTED});return n.a.createElement("div",null,n.a.createElement("div",{className:"shazam-container"},n.a.createElement("div",{onClick:this.toggleRecording,className:s},n.a.createElement("div",{className:"c-shape"}),n.a.createElement("div",{className:"c-shape reverse"})),n.a.createElement("div",{className:"outer-circle ".concat(this.state.isAnimating?"outer-circle--animate":"")}),n.a.createElement("div",{className:"outer-circle2 ".concat(this.state.isAnimating?"outer-circle2--animate":"")})),!t&&n.a.createElement("div",{className:"lyrics-search"},n.a.createElement(f.a,{icon:g.a})),n.a.createElement(p.a,null))}}]),t}(n.a.Component);Boolean("localhost"===window.location.hostname||"[::1]"===window.location.hostname||window.location.hostname.match(/^127(?:\.(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)){3}$/));r.a.render(n.a.createElement(R,null),document.getElementById("root")),"serviceWorker"in navigator&&navigator.serviceWorker.ready.then((function(e){e.unregister()}))}},[[27,1,2]]]);
//# sourceMappingURL=main.a3af3051.chunk.js.map